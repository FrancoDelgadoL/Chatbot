define(['jquery','Magento_Customer/js/customer-data'],function($,customerData){'use strict';var cartData=customerData.get('cart');function eventError(error_message,updatedCart){let storeClosedEven={'event':'site_error','error_message':error_message,'error_type':'system','error_place':'carrito de compra','section':'carrito de compra','items':[],};if(updatedCart.length>0){$.each((updatedCart),function(i,element){storeClosedEven.items.push({'index:':i,'item_name:':element.product_name,'item_id:':element.sku_main,'price':parseFloat(element.product_price_value).toFixed(2),})});}
window.dataLayer.push(storeClosedEven);}
function storeClosed(config){let lastTotal=parseFloat(config.total)
cartData.subscribe(function(updatedCart){let newTotal=parseFloat(updatedCart.subtotalAmount)
let error_message=`${updatedCart.store_name} se encuentra cerrada. ${updatedCart.schedule_msg} ${updatedCart.frontend_description}`;if((newTotal)>lastTotal&&updatedCart.possible_onepage_checkout==false){eventError(error_message,updatedCart.items);lastTotal=newTotal;}
if((newTotal)<lastTotal&&updatedCart.possible_onepage_checkout==false){eventError(error_message,updatedCart.items);lastTotal=newTotal;}});return false;}
return function(config){$(document).on('ga:inited');storeClosed(config)
$('a.action.showcart').on('click',function(){var latestCartValue=cartData();let error_message=`${latestCartValue.store_name} se encuentra cerrada. ${latestCartValue.schedule_msg} ${latestCartValue.frontend_description}`;if(latestCartValue.possible_onepage_checkout==false){eventError(error_message,latestCartValue.items);}})};});